Subject: [PATCH] m68k: Atari EtherNEC workqueue updates

Workqueue updates for the Atari EtherNEC driver

Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
---
 drivers/net/atari_ethernec.c |    7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

--- linux-m68k-2.6.21.orig/drivers/net/atari_ethernec.c
+++ linux-m68k-2.6.21/drivers/net/atari_ethernec.c
@@ -96,6 +96,7 @@ static const char version2[] =
 #include <linux/netdevice.h>
 #include <linux/etherdevice.h>
 #include <linux/jiffies.h>
+#include <linux/workqueue.h>
 
 #include <asm/system.h>
 #include <asm/atarihw.h>
@@ -222,7 +223,7 @@ static int use_poll;
  */
 static wait_queue_head_t WaitQ;
 
-static struct work_struct tqueue;
+static struct delayed_work tqueue;
 
 #ifdef ETHERNEC_USE_POLL
 static struct {
@@ -234,7 +235,7 @@ static struct {
 
 static struct net_device *poll_dev = NULL;
 
-static void atari_ethernec_int(unsigned long dev_addr)
+static void atari_ethernec_int(struct work_struct *work)
 {
 	struct net_device *dev = poll_dev;
 
@@ -281,7 +282,7 @@ static void atari_ethernec_start_poll(st
 
 	init_waitqueue_head(&WaitQ);
 
-	INIT_WORK(&tqueue, (void (*)(void *))atari_ethernec_int, dev);
+	INIT_DELAYED_WORK(&tqueue, atari_ethernec_int);
 	schedule_delayed_work(&tqueue, 1);
 #ifdef ETHERNEC_USE_POLL
 	if (!poll_ops.poll_queue.func ||
