commit 107d922706cd36f3bb79bcca9bc4678c32f22e59
Author: Vincent Danen <vdanen@redhat.com>
Date:   Wed Mar 24 21:46:10 2010 +0900

    fix format string vulnerability
    
    The isns code has the same problem:
    
    http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=574935
    
    Signed-off-by: FUJITA Tomonori <fujita.tomonori@lab.ntt.co.jp>

diff --git a/usr/iscsi/isns.c b/usr/iscsi/isns.c
index 3bfc1fc..c4d90cf 100644
--- a/usr/iscsi/isns.c
+++ b/usr/iscsi/isns.c
@@ -316,7 +316,7 @@ static int isns_attr_query(char *name)
 	tlv = (struct isns_tlv *) hdr->pdu;
 
 	if (name)
-		snprintf(mgmt->name, sizeof(mgmt->name), name);
+		snprintf(mgmt->name, sizeof(mgmt->name), "%s", name);
 	else {
 		mgmt->name[0] = '\0';
 		target = list_first_entry(&iscsi_targets_list,
@@ -690,7 +690,7 @@ found:
 				ini = malloc(sizeof(*ini));
 				if (!ini)
 					goto free_qry_mgmt;
-				snprintf(ini->name, sizeof(ini->name), name);
+				snprintf(ini->name, sizeof(ini->name), "%s", name);
 				list_add(&ini->ilist, &target->isns_list);
 			} else
 				name = NULL;
